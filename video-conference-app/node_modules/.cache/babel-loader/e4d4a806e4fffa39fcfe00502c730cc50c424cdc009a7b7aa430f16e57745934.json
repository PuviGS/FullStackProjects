{"ast":null,"code":"var _jsxFileName = \"/home/puvi/Desktop/video-conference-app/src/components/Room.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport socket from '../socket';\nimport SimplePeer from 'simple-peer';\nimport VideoPlayer from './VideoPlayer';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Room = ({\n  roomId\n}) => {\n  _s();\n  const [peers, setPeers] = useState([]);\n  const myVideo = useRef();\n  const videoGrid = useRef();\n  useEffect(() => {\n    navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true\n    }).then(stream => {\n      myVideo.current.srcObject = stream;\n      socket.emit('join-room', roomId, socket.id);\n      socket.on('user-connected', userId => {\n        const peer = createPeer(userId, socket.id, stream);\n        setPeers(peers => [...peers, {\n          peerID: userId,\n          peer\n        }]);\n      });\n      socket.on('user-disconnected', userId => {\n        setPeers(prevPeers => prevPeers.filter(p => p.peerID !== userId));\n      });\n      socket.on('receiving-returned-signal', payload => {\n        const item = peers.find(p => p.peerID === payload.id);\n        item.peer.signal(payload.signal);\n      });\n    });\n  }, [roomId]);\n  function createPeer(userToSignal, callerID, stream) {\n    const peer = new SimplePeer({\n      initiator: true,\n      trickle: false,\n      stream\n    });\n    peer.on('signal', signal => {\n      socket.emit('sending-signal', {\n        userToSignal,\n        callerID,\n        signal\n      });\n    });\n    return peer;\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"room\",\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      playsInline: true,\n      muted: true,\n      ref: myVideo,\n      autoPlay: true,\n      className: \"my-video\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: videoGrid,\n      className: \"video-grid\",\n      children: peers.map(peerObj => /*#__PURE__*/_jsxDEV(VideoPlayer, {\n        peer: peerObj.peer\n      }, peerObj.peerID, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 21\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 9\n  }, this);\n};\n_s(Room, \"UxJ4Fa3kmYNfpMurPTNo5yfNAoY=\");\n_c = Room;\nexport default Room;\nvar _c;\n$RefreshReg$(_c, \"Room\");","map":{"version":3,"names":["React","useEffect","useRef","useState","socket","SimplePeer","VideoPlayer","jsxDEV","_jsxDEV","Room","roomId","_s","peers","setPeers","myVideo","videoGrid","navigator","mediaDevices","getUserMedia","video","audio","then","stream","current","srcObject","emit","id","on","userId","peer","createPeer","peerID","prevPeers","filter","p","payload","item","find","signal","userToSignal","callerID","initiator","trickle","className","children","playsInline","muted","ref","autoPlay","fileName","_jsxFileName","lineNumber","columnNumber","map","peerObj","_c","$RefreshReg$"],"sources":["/home/puvi/Desktop/video-conference-app/src/components/Room.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport socket from '../socket';\nimport SimplePeer from 'simple-peer';\nimport VideoPlayer from './VideoPlayer';\n\nconst Room = ({ roomId }) => {\n    const [peers, setPeers] = useState([]);\n    const myVideo = useRef();\n    const videoGrid = useRef();\n\n    useEffect(() => {\n        navigator.mediaDevices.getUserMedia({ video: true, audio: true }).then((stream) => {\n            myVideo.current.srcObject = stream;\n\n            socket.emit('join-room', roomId, socket.id);\n\n            socket.on('user-connected', (userId) => {\n                const peer = createPeer(userId, socket.id, stream);\n                setPeers((peers) => [...peers, { peerID: userId, peer }]);\n            });\n\n            socket.on('user-disconnected', (userId) => {\n                setPeers((prevPeers) => prevPeers.filter((p) => p.peerID !== userId));\n            });\n\n            socket.on('receiving-returned-signal', (payload) => {\n                const item = peers.find((p) => p.peerID === payload.id);\n                item.peer.signal(payload.signal);\n            });\n        });\n\n    }, [roomId]);\n\n    function createPeer(userToSignal, callerID, stream) {\n        const peer = new SimplePeer({\n            initiator: true,\n            trickle: false,\n            stream\n        });\n\n        peer.on('signal', (signal) => {\n            socket.emit('sending-signal', { userToSignal, callerID, signal });\n        });\n\n        return peer;\n    }\n\n    return (\n        <div className=\"room\">\n            <video playsInline muted ref={myVideo} autoPlay className=\"my-video\"></video>\n            <div ref={videoGrid} className=\"video-grid\">\n                {peers.map((peerObj) => (\n                    <VideoPlayer key={peerObj.peerID} peer={peerObj.peer} />\n                ))}\n            </div>\n        </div>\n    );\n};\n\nexport default Room;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}